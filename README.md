## About
Working in Cybersecurity can feel overwhelming at times, there are constant changes, and it can feel impossible to keep up to date. To ensure I am aware of critical and all vulnerabilities posted to the National Vulnerability Database, I wrote this script. The goal of the script was to get an email notification every day to show me all the new vulnerabilities posted but, also highlight those with a critical score.

## Prerequisites/Additional Setup
To get this up and running, you only really need to configure two things:
#### Email configurations
First, you need an email account that will be sending the notifications. For my use case I created a new Gmail account and for that I followed Lei Mao's guide on sending emails via Python. All credit for the email sending process goes to Lei Mao and I will leave the link to the page here: https://leimao.github.io/blog/Python-Send-Gmail/. As he highlights, you will need to grab an "App Password", search this in the settings search bar if it does not appear on the main account settings page. Make sure to insert the sender email address, recipients, and app password in the "setup for email" section. See below for reference.
```
# Setup for email
port = 465  # For SSL
smtp_server = "smtp.gmail.com"
sender_email = "Sender email address"  # Configure a new email and enable MFA
# List of recipient email addresses
receiver_emails = ["Email address 1", "Email address 2"]
# In new email, search 'app passwords' after MFA enabled to retreive
password = "16 character app password"
```
#### Cloud setup/scheduled run
Now that the script is set up to search NVD and email you with newly posted vulnerabilities, you may want to set this up to run on a schedule. Now, there are a few ways of doing this. 
1. Set up a scheduled run on your Windows 10 machine and have it run that way, but this means your computer must be on. You could set up an old laptop as a server of sorts and have it always powered on, but, let's be honest - that's a hassle. 
2. Set it up in a cloud environment. There are plenty of options out there and depending on your needs, you may decide to go with another hosting provider but, I found PythonAnywhere to work great. I simply added the file to my "files" and then set it to run every day at a specific time via the "tasks" dashboard. Just remember the time is in UT, so you will need to convert to your timezone.

## Instillation
Install all the required modules for the script to operate:

NVDlib
```pip install nvdlib```

epss_api
```pip install epss_api```

Repeat for any other modules which are shown in error messages upon the script's execution. However, those are the main modules which are not installed by default. The syntax for installing modules is the same for all but, in the case you are experiencing issues installing a module, just google it! 


## Output
Early stages of the script had the output sent to the console however, when running in a cloud environment and sending the results to an email address automatically, it doesn't make sense to have anything printed to the console. With this in mind, I had the output formatted in an email which could be sent to the specified email every day. However, a friend of mine (Mukv1) had been using the script and made a change which formatted the output into .csv format. This was a great addition and with his permission I made that the new base script, later making some slight changes. 

##### Old email format
![image](https://github.com/DevinM17/CVE-Alerts/assets/95002315/c61b5e15-77e0-4387-9076-41a97770d94d)

##### New email format
![image](https://github.com/DevinM17/CVE-Alerts/assets/95002315/0e9f0f16-ffd5-4816-9907-add8770efa36)

## CVE Scores
You may notice from the output above that the score can sometimes be shown as "None". This happens when a CVE is posted without a score assigned by the vendor and also does not have a CVE score from the NVD analysis yet as it is too new to have been analyzed. 

## EPSS Scores
A feature I recently added was to use the list of CVEs pulled from NVD within the given timeframe and use the Exploit Prediction Scoring System (EPSS) to display the EPSS percent for each vulnerability (when available). First.org does have detailed documentation on how to use their API but, I opted to utilize a python module similar to nvdlib but, for epss. This is why you also need to pip install epss_api prior to using the script. For more information about the Exploit Prediction Scoring System , reference the following: https://www.first.org/epss/

## Disclaimer
Please note that I am not a professional programmer and this script is far from optimized. I am sure there is a much more efficient way to do this, but, it works for my use case. Also, I want to note that this project was made possible due to the countless other sources such as NVDlib documentation, Lei Mao's guide on email notifications in Python, GeekforGeeks tuple conversion function, and even ChatGPT which helped me solve the filtering issue I was having when trying to sort by critical CVEs, thanks GPT :)

Also, feel free to modify the script to better fit your needs. Remove the email notification feature and just see the output in your console. Change the start and end date and only receive notification at the end of the week highlighting all critical CVEs posted that given week. Do whatever will make this work best for you.

## Contributors
Special thanks to Mukv1 who helped developed the .csv formatting functionality of the script. Mukv1 is not an offical contributor to the project and will help with new features and fixes in the future.

